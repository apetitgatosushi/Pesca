<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gato Premiado üê±‚ú®</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(-45deg, #000, #111, #222, #000);
      background-size: 400% 400%;
      animation: gradient 10s ease infinite;
      font-family: 'Poppins', sans-serif;
      color: white;
      text-align: center;
    }
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    h1 {
      margin: 10px 0;
      font-size: 2.2em;
      color: gold;
      text-shadow: 0 0 15px rgba(255,215,0,0.8);
    }
    #timer {
      font-size: 1.3em;
      color: gold;
      text-shadow: 0 0 10px black;
    }
    canvas {
      display: block;
      margin: auto;
      background: transparent;
      width: 95vw;   /* largura adapt√°vel */
      height: 60vh;  /* altura adapt√°vel */
      max-width: 800px;
      max-height: 500px;
    }
    #prizeBox {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: #111;
      border: 3px solid gold;
      border-radius: 20px;
      padding: 20px 30px;
      font-size: 1.5em;
      color: gold;
      text-shadow: 0 0 10px black;
      animation: none;
      z-index: 10;
    }
    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); }
    }
    /* Gato emoji */
    #cat {
      position: absolute;
      bottom: 50px;
      left: 20px;
      font-size: clamp(40px, 8vw, 60px); /* responsivo */
      animation: wiggle 2s infinite alternate;
    }
    @keyframes wiggle {
      from { transform: rotate(-5deg); }
      to { transform: rotate(5deg); }
    }
    #speech {
      position: absolute;
      bottom: 120px;
      left: 80px;
      background: #fff;
      color: #000;
      padding: 8px 12px;
      border-radius: 10px;
      font-size: clamp(12px, 3vw, 16px);
      display: none;
    }
    /* Cr√©ditos sutis */
    #credits-left, #credits-right {
      position: fixed;
      bottom: 5px;
      font-size: clamp(10px, 2.5vw, 12px);
      color: #aaa;
    }
    #credits-left { left: 10px; }
    #credits-right { right: 10px; }
    /* Efeito clique */
    .clickEffect {
      position: absolute;
      font-size: 24px;
      color: gold;
      pointer-events: none;
      animation: popFade 0.8s ease-out forwards;
    }
    @keyframes popFade {
      0% { transform: scale(0.5); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.9; }
      100% { transform: scale(1); opacity: 0; top: -20px; }
    }
  </style>
</head>
<body>
  <h1>üê± Gato Premiado üêü</h1>
  <div id="timer">Tempo: 60s</div>
  <canvas id="gameCanvas"></canvas>
  <div id="prizeBox"></div>
  <div id="cat">üê±</div>
  <div id="speech">Vai nessa, voc√™ consegue!</div>

  <div id="credits-left">Apetit Gat√¥ Sushi</div>
  <div id="credits-right">By Maria Baniski</div>
  
  <audio id="catchSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7b8f0ec6da.mp3"></audio>
  <audio id="failSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_77dbb07a72.mp3"></audio>
  <audio id="winSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_f6d7bbf39a.mp3"></audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const prizeBox = document.getElementById("prizeBox");
    const timerEl = document.getElementById("timer");
    const speech = document.getElementById("speech");

    function resizeCanvas() {
      canvas.width = canvas.clientWidth;
      canvas.height = canvas.clientHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    let attempts = true;
    let gameOver = false;
    let timeLeft = 60;
    let startTime = Date.now();
    const minWinTime = 10000; // 10 segundos

    // Bloqueio por dia
    const today = new Date().toISOString().split("T")[0];
    const lastWin = localStorage.getItem("lastWinDate");
    if (lastWin === today) {
      attempts = false;
      gameOver = true;
      speech.innerText = "Miauu! Voc√™ j√° ganhou hoje üêæ volte amanh√£!";
      speech.style.display = "block";
    }

    const prizes = [
      "Suco Kappo",
      "Coca Cola Caf√©",
      "Sobremesa",
      "Harumaki",
      "Por√ß√£o Surpresa",
      ...Array(12).fill("N√£o foi dessa vez")
    ];

    const emojis = ["üêü","üç£","üç§","üç•","üç°"];
    const fish = [];

    function createFish() {
      return {
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        speed: 3 + Math.random() * 3, // velocidade ajustada
        size: 30 + Math.random() * 20,
        emoji: emojis[Math.floor(Math.random() * emojis.length)],
        angle: 0
      };
    }
    for(let i=0;i<7;i++) fish.push(createFish());

    function drawFish(f) {
      ctx.save();
      ctx.translate(f.x, f.y);
      ctx.rotate(Math.sin(f.angle) * 0.3);
      ctx.font = (f.size * (canvas.width/800))+"px Arial"; // proporcional
      ctx.fillText(f.emoji, 0, 0);
      ctx.restore();
    }

    function updateFish(f) {
      f.x += f.speed;
      f.angle += 0.1;
      if(f.x > canvas.width+50) {
        f.x = -50;
        f.y = Math.random() * canvas.height;
      }
    }

    function gameLoop() {
      if (gameOver) return;
      ctx.clearRect(0,0,canvas.width,canvas.height);
      fish.forEach(f => {
        updateFish(f);
        drawFish(f);
      });
      requestAnimationFrame(gameLoop);
    }
    gameLoop();

    canvas.addEventListener("click", e=>{
      if(!attempts || gameOver) return;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      // efeito clique
      const effect = document.createElement("div");
      effect.className = "clickEffect";
      effect.innerText = "‚ú®";
      effect.style.left = (e.pageX - 10) + "px";
      effect.style.top = (e.pageY - 20) + "px";
      document.body.appendChild(effect);
      setTimeout(()=>effect.remove(),800);

      const caught = fish.find(f=> Math.hypot(f.x-x,f.y-y)<f.size);
      if(caught){
        document.getElementById("catchSound").play();
        let now = Date.now();
        let prize = prizes[Math.floor(Math.random()*prizes.length)];

        if (now - startTime < minWinTime) {
          prize = "N√£o foi dessa vez";
        }

        if(prize==="N√£o foi dessa vez"){
          speech.innerText="Quase, miauuu!";
          speech.style.display="block";
          setTimeout(()=>speech.style.display="none",1500);
        } else {
          document.getElementById("winSound").play();
          prizeBox.innerText="üéâ Parab√©ns! Voc√™ ganhou: "+prize;
          prizeBox.style.animation="pop 0.6s forwards";
          speech.innerText="Uau! Voc√™ conseguiu üéâ";
          speech.style.display="block";
          confetti({
            particleCount: 150,
            spread: 90,
            origin: { y: 0.6 },
            colors: ["#FFD700","#FFFACD","#FF4500"]
          });
          attempts = false;
          gameOver = true;
          localStorage.setItem("lastWinDate", today);
          clearInterval(timerInterval);
        }
      }
    });

    const timerInterval = setInterval(()=>{
      if (timeLeft <= 0 && !gameOver) {
        gameOver = true;
        prizeBox.innerText="N√£o foi dessa vez üí¶";
        prizeBox.style.animation="pop 0.6s forwards";
        speech.innerText="Miauu... n√£o foi dessa vez üòø";
        speech.style.display="block";
        document.getElementById("failSound").play();
        clearInterval(timerInterval);
      } else if (!gameOver) {
        timeLeft--;
        timerEl.innerText = "Tempo: " + timeLeft + "s";
      }
    },1000);
  </script>
</body>
</html>
